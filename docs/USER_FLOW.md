# User Flow: FAA Strategy Calculator

> Version: 1.0 | Date: 2026-01-07

---

## 1. 전체 사용자 여정

```mermaid
flowchart TD
    A[앱 진입] --> B{LocalStorage 저장 종목?}
    B -->|Yes| C[저장된 종목 불러오기]
    B -->|No| D[기본 종목 표시]
    C --> E[메인 페이지]
    D --> E
    E --> F[종목 입력/수정]
    E --> G[스코어 계산]
    E --> H[투자 배분]
    E --> I[백테스트]
```

---

## 2. 종목 입력 플로우 (FEAT-1)

```mermaid
flowchart TD
    A[종목 입력 시작] --> B{기본값 사용?}
    B -->|Yes| C[기본 종목 자동 채움]
    B -->|No| D[사용자 직접 입력]
    D --> E[티커 입력]
    E --> F[API 검증 호출]
    F --> G{유효?}
    G -->|Yes| H[유효 표시]
    G -->|No| I[에러 표시]
    H --> J{7개 완료?}
    J -->|No| E
    J -->|Yes| K[LocalStorage 저장]
    K --> L[계산 버튼 활성화]
```

---

## 3. 스코어 계산 플로우 (FEAT-2)

```mermaid
flowchart TD
    A[계산 버튼 클릭] --> B{7개 유효?}
    B -->|No| C[에러 표시]
    B -->|Yes| D[API score 호출]
    D --> E[로딩 표시]
    E --> F{응답?}
    F -->|성공| G[스코어 테이블 렌더링]
    F -->|실패| H[에러 + 재시도]
    G --> I[상위 3개 하이라이트]
    I --> J{모멘텀 음수?}
    J -->|Yes| K[현금 대체 라벨]
    J -->|No| L[최종 선정 표시]
    K --> L
```

---

## 4. 투자 배분 플로우 (FEAT-3)

```mermaid
flowchart TD
    A[스코어 계산 완료] --> B[투자 금액 입력]
    B --> C{유효 금액?}
    C -->|No| D[에러 표시]
    C -->|Yes| E[균등 배분 계산]
    E --> F[배분 결과 표시]
    F --> G[LocalStorage 저장]
```

---

## 5. 백테스트 플로우 (FEAT-5)

```mermaid
flowchart TD
    A[백테스트 탭] --> B{종목 설정 완료?}
    B -->|No| C[메인으로 안내]
    B -->|Yes| D[시작일 선택]
    D --> E[API backtest 호출]
    E --> F[로딩 표시]
    F --> G{응답?}
    G -->|성공| H[차트 렌더링]
    G -->|실패| I[에러 표시]
    H --> J[성과 지표 표시]
```

---

## 6. 메인 페이지 상태

```mermaid
stateDiagram-v2
    [*] --> 초기상태
    초기상태 --> 종목입력중
    종목입력중 --> 계산준비완료: 7개 완료
    계산준비완료 --> 계산중: 계산 클릭
    계산중 --> 결과표시: 성공
    결과표시 --> 배분완료: 금액 입력
```

---

## REQ ↔ Flow 매핑

| REQ ID | 요구사항 | 플로우 |
|--------|----------|--------|
| REQ-1.1~1.4 | 종목 입력/검증 | 종목 입력 플로우 |
| REQ-2.1~2.7 | FAA 스코어 계산 | 스코어 계산 플로우 |
| REQ-3.1~3.3 | 투자 배분 | 투자 배분 플로우 |
| REQ-5.1~5.5 | 백테스트 | 백테스트 플로우 |
